---
slug: /versioning
---

# Gestion des versions

Vous pouvez utiliser la CLI de version pour cr√©er une nouvelle version de documentation bas√©e sur le contenu le plus r√©cent dans le r√©pertoire `docs`. Cet ensemble sp√©cifique de documentation sera alors pr√©serv√© et accessible m√™me lorsque la documentation dans le r√©pertoire `docs` continue d'√©voluer.

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

:::warning

Pensez-y avant de commencer √† versionner votre documentation - il peut devenir difficile pour les contributeurs de contribuer √† son am√©lioration !

:::

La plupart du temps, vous n'avez pas besoin de gestion des versions, car cela ne fait qu'augmenter le temps de construction et complexifier votre base de code. La gestion des versions est **plus adapt√©e aux sites web √† fort trafic et aux modifications rapides de la documentation entre les versions**. Si votre documentation change rarement, n'ajoutez pas de gestion de version √† votre documentation.

Pour mieux comprendre le fonctionnement de la gestion de version et voir s'il r√©pond √† vos besoins, vous pouvez lire ce qui suit.

## Vue d'ensemble {#overview}

Un site typique de doc versionn√© ressemble √† ce qui suit¬†:

```bash
website
‚îú‚îÄ‚îÄ sidebars.json        # barre lat√©rale pour la version courante
‚îú‚îÄ‚îÄ docs                 # r√©pertoire docs pour la version courante
‚îÇ   ‚îú‚îÄ‚îÄ foo
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bar.md       # https://mysite.com/docs/next/foo/bar
‚îÇ   ‚îî‚îÄ‚îÄ hello.md         # https://mysite.com/docs/next/hello
‚îú‚îÄ‚îÄ versions.json        # fichier pour indiquer quelles versions sont disponibles
‚îú‚îÄ‚îÄ versioned_docs
‚îÇ   ‚îú‚îÄ‚îÄ version-1.1.0
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ foo
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bar.md   # https://mysite.com/docs/foo/bar
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hello.md
‚îÇ   ‚îî‚îÄ‚îÄ version-1.0.0
‚îÇ       ‚îú‚îÄ‚îÄ foo
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ bar.md   # https://mysite.com/docs/1.0.0/foo/bar
‚îÇ       ‚îî‚îÄ‚îÄ hello.md
‚îú‚îÄ‚îÄ versioned_sidebars
‚îÇ   ‚îú‚îÄ‚îÄ version-1.1.0-sidebars.json
‚îÇ   ‚îî‚îÄ‚îÄ version-1.0.0-sidebars.json
‚îú‚îÄ‚îÄ docusaurus.config.js
‚îî‚îÄ‚îÄ package.json
```

Le fichier `versions.json` est une liste de noms de version, ordonn√©e du plus r√©cent au plus ancien.

Le tableau ci-dessous explique comment un fichier versionn√© correspond √† sa version et √† l'URL g√©n√©r√©e.

| Chemin                                  | Version        | URL               |
| --------------------------------------- | -------------- | ----------------- |
| `versioned_docs/version-1.0.0/hello.md` | 1.0.0          | /docs/1.0.0/hello |
| `versioned_docs/version-1.1.0/hello.md` | 1.1.0 (latest) | /docs/hello       |
| `docs/hello.md`                         | current        | /docs/next/hello  |

:::tip

Les fichiers dans le r√©pertoire `>docs` appartiennent √† la version `current`.

Par d√©faut, la version de la documentation `current` est √©tiquet√©e `Next` et h√©berg√©e sous `/docs/next/*`, mais elle est enti√®rement configurable pour s'adapter au cycle de vie des versions de votre projet.

:::

### Terminologie {#terminology}

Notez la terminologie que nous utilisons ici.

<dl>
  <dt>
    <b>Version actuelle</b>
  </dt>
  <dd>
    {'La version est plac√©e dans le '}
    {'dossier '}
    <code>./docs</code>
  </dd>
  <dt>
    <b>Derni√®re version</b>
  </dt>
  <dd>
    {'La version servie par d√©faut pour les √©l√©ments de la barre de navigation docs. Habituellement a le chemin '}
    <code>/docs</code>
    {'.'}
  </dd>
</dl>

La version actuelle est d√©finie par l'emplacement **du syst√®me de fichiers**, alors que la derni√®re version est d√©finie par le **comportement de navigation**. Il peut s'agir ou non de la m√™me version¬†! (Et la configuration par d√©faut, comme indiqu√© dans le tableau ci-dessus, les traiterait comme diff√©rentes : la version actuelle vers `/docs/next` et la derni√®re vers `/docs`)

## Tutoriels {#tutorials}

### Taguer une nouvelle version {#tagging-a-new-version}

1. Tout d'abord, assurez-vous que la version actuelle de la documentation (le r√©pertoire `./docs` ) est pr√™te √† √™tre gel√©e.
2. Entrez un nouveau num√©ro de version.

```bash npm2yarn
npm run docusaurus docs:version 1.1.0
```

Lorsqu'on tague une nouvelle version, le m√©canisme de gestion des versions du document :

- Copiera le contenu complet du dossier `docs/` dans un nouveau dossier `versioned_docs/version-[versionName]/`.
- Cr√©era un fichier de barres lat√©rales versionn√©es bas√© sur votre configuration actuelle [sidebar](./sidebar/index.mdx) (si elle existe) - enregistr√© sous le nom `versioned_sidebars/version-[versionName]-sidebars.json`.
- Ajout du num√©ro de la nouvelle version dans `versions.json`.

### Cr√©ation de nouvelles docs {#creating-new-docs}

1. Placez le nouveau fichier dans le dossier de la version correspondante.
2. Ajoutez la r√©f√©rence du nouveau fichier dans le fichier de la barre lat√©rale correspondante, selon le num√©ro de version.

```mdx-code-block
<Tabs>
<TabItem value="Current version structure">
```

```bash
# Le nouveau fichier.
docs/new.md

# Modifier le fichier de la barre lat√©rale correspondante.
sidebars.js
```

```mdx-code-block
</TabItem>
<TabItem value="Older version structure">
```

```bash
# Le nouveau fichier.
versioned_docs/version-1.0.0/new.md

# Modifier le fichier de la barre lat√©rale correspondante.
versioned_sidebars/version-1.0.0-sidebars.json
```

```mdx-code-block
</TabItem>
</Tabs>
```

:::tip

Les fichiers de barres lat√©rales versionn√©es sont, comme les fichiers de barres lat√©rales standard, relatifs √† la racine du contenu pour la version donn√©e¬†:

```json
{
  "sidebar": [
    {
      "type": "autogenerated",
      "dirName": "."
    }
  ]
}
```

ou pour une barre lat√©rale manuelle¬†:

```json
{
  "sidebar": [
    {
      "type": "doc",
      "id": "new",
      "label": "New"
    }
  ]
}
```

:::

### Mise √† jour d'une version existante {#updating-an-existing-version}

Vous pouvez mettre √† jour plusieurs versions de docs en m√™me temps car chaque r√©pertoire dans `versioned_docs/` repr√©sente des routes sp√©cifiques lorsqu'il est publi√©.

1. Modifiez n'importe quel fichier.
2. Validez et soumettez les modifications.
3. Il sera publi√© dans la version.

Exemple: Lorsque vous changez n'importe quel fichier dans `versioned_docs/version-2.6/`, cela n'affectera que la documentation pour la version `2.6`.

### Suppression d'une version existante {#deleting-an-existing-version}

Vous pouvez √©galement supprimer/retirer des versions.

1. Retirez la version depuis le fichier `versions.json`.

Exemple :

```diff
[
  "2.0.0",
  "1.9.0",
  // highlight-next-line
- "1.8.0"
]
```

2. Supprimez le r√©pertoire de la documentation versionn√©e. Exemple : `versioned_docs/version-1.8.0`.
3. Supprimez le fichier versionn√© de la barre lat√©rale. Exemple : `versioned_sidebars/version-1.8.0-sidebars.json`.

## Configuration du comportement des versions {#configuring-versioning-behavior}

La version ¬´¬†current¬†¬ª est le nom de la version de la documentation qui se trouve dans le dossier `./docs`. Il y a diff√©rentes mani√®res de g√©rer les versions, mais les deux pratiques courantes sont :

- Vous publiez la v1 et commencez imm√©diatement √† travailler sur la v2 (y compris sa documentation). Dans ce cas, la **version actuelle** est v2, qui se trouve dans le dossier source `./docs`, et peut √™tre parcouru via `example.com/docs/next`. La **derni√®re version** est v1, qui est dans le dossier source `./versioned_docs/version-1`, et est parcouru par la plupart de vos utilisateurs via `example.com/docs`.
- Vous publiez la v1, et la maintiendrez pendant une certain temps avant de penser √† la v2. Dans ce cas, la **version actuelle** et la **derni√®re version** pointeront vers v1, car la v2 des docs n'existe pas encore¬†!

La configuration par d√©faut de Docusaurus fonctionnent tr√®s bien pour le premier cas d'utilisation. Nous allons √©tiqueter la version actuelle comme "next" et vous pouvez m√™me choisir de ne pas la publier.

**Pour le 2nd cas** : si vous publiez la v1 et ne pr√©voyez pas de travailler sur la v2 bient√¥t, au lieu de versionner la v1 et d'avoir √† maintenir les fichiers dans deux dossiers (`./docs` + `./versioned_docs/version-1.0.0`), vous pouvez envisager de "pr√©tendre" que la version actuelle est une version d√©coup√©e en lui donnant un chemin et un libell√©¬†:

```js title="docusaurus.config.js"
export default {
  presets: [
    '@docusaurus/preset-classic',
    docs: {
      // highlight-start
      lastVersion: 'current',
      versions: {
        current: {
          label: '1.0.0',
          path: '1.0.0',
        },
      },
      // highlight-end
    },
  ],
};
```

Les docs dans `./docs` seront servis depuis `/docs/1. . 0` au lieu de `/docs/next` et `1.0.` deviendra la version par d√©faut vers laquelle nous avons un lien dans le menu d√©roulant de la barre de navigation, et vous n'aurez besoin que de maintenir un seul dossier `./docs`.

Nous offrons ces options de plugin pour personnaliser le comportement des versions¬†:

- `disableVersioning`¬†: D√©sactive explicitement le versionnage m√™me avec les versions. Ainsi, le site n'inclura que la version actuelle.
- `includeCurrentVersion`¬†: Inclue la version actuelle (le dossier `./docs`) de vos docs.
  - **Astuce**¬†: d√©sactivez-le si la version actuelle est en cours, pas pr√™te √† √™tre publi√©e.
- `lastVersion`¬†: D√©finit √† quelle version la "derni√®re version" (la route `/docs`) fait r√©f√©rence.
  - **Astuce**¬†: `lastVersion: 'current'` a un sens si votre version actuelle fait r√©f√©rence √† une version majeure constamment corrig√©e et publi√©e. Le chemin de base et le libell√© de la derni√®re version sont configurables.
- `onlyIncludeVersions`¬†: D√©finit un sous-ensemble de versions de `versions.json` √† d√©ployer.
  - **Astuce**¬†: limitez √† 2 ou 3 versions en dev et d√©ployez des aper√ßus pour am√©liorer le temps de d√©marrage et de compilation.
- `versions`¬†: Un dictionnaire de m√©tadonn√©es de version. Pour chaque version, vous pouvez personnaliser les √©l√©ments suivants¬†:
  - `label`¬†: le libell√© affich√© dans le menu d√©roulant des versions et la banni√®re.
  - `path`¬†: le chemin de base de la route de cette version. Par d√©faut, la derni√®re version a `/` et la version actuelle a `/next`.
  - `banner`¬†: l'une des valeurs suivantes `'none'`, `'unreleased'` et `'unmaintained'`. D√©termine ce qui est affich√© en haut de chaque page de documentation. Toute version sup√©rieure √† la derni√®re version serait "unreleased", et toute version inf√©rieure serait "unmaintained".
  - `badge`¬†: montre un badge avec le nom de version en haut d'un doc de cette version.
  - `className`¬†: ajoute un `className` personnalis√© √† l'√©l√©ment `<html>` aux pages de doc de cette version.

Consulter [la configuration du plugin docs](../../api/plugins/plugin-content-docs.mdx#configuration) pour plus de d√©tails.

## √âl√©ments de la barre de navigation {#navbar-items}

We offer several docs navbar items to help you quickly set up navigation without worrying about versioned routes.

- [`doc`](../../api/themes/theme-configuration.mdx#navbar-doc-link)¬†: un lien vers un doc.
- [`docSidebar`](../../api/themes/theme-configuration.mdx#navbar-doc-sidebar)¬†: un lien vers le premier √©l√©ment d'une barre lat√©rale.
- [`docsVersion`](../../api/themes/theme-configuration.mdx#navbar-docs-version)¬†: un lien vers le doc principal de la version actuellement consult√©e.
- [`docsVersionDropdown`](../../api/themes/theme-configuration.mdx#navbar-docs-version-dropdown)¬†: un menu d√©roulant contenant toutes les versions disponibles.

Ces liens rechercheront tous une version appropri√©e √† laquelle se rattacher, dans l'ordre suivant¬†:

1. **Version active**¬†: la version sur laquelle l'utilisateur navigue actuellement, si elle se trouve sur une page fournie par ce plugin de doc. Si elle n'est pas sur une page de doc, elle se rabat sur la...
2. **Version pr√©f√©r√©e**¬†: la version que l'utilisateur a consult√©e pour la derni√®re fois. S'il n'y a pas d'historique, elle se rabat sur la...
3. **Derni√®re version**¬†: la version par d√©faut vers laquelle nous naviguons, configur√©e par l'option `lastVersion`.

## `docsVersionDropdown` {#docsVersionDropdown}

By default, the [`docsVersionDropdown`](../../api/themes/theme-configuration.mdx#navbar-docs-version-dropdown) displays a dropdown with all the available docs versions.

The `versions` attribute allows you to display a subset of the available docs versions in a given order:

```js title="docusaurus.config.js"
export default {
  themeConfig: {
    navbar: {
      items: [
        {
          type: 'docsVersionDropdown',
          // highlight-start
          versions: ['current', '3.0', '2.0'],
          // highlight-end
        },
      ],
    },
  },
};
```

Passing a `versions` object, lets you override the display label of each version:

```js title="docusaurus.config.js"
export default {
  themeConfig: {
    navbar: {
      items: [
        {
          type: 'docsVersionDropdown',
          // highlight-start
          versions: {
            current: {label: 'Version 4.0'},
            '3.0': {label: 'Version 3.0'},
            '2.0': {label: 'Version 2.0'},
          },
          // highlight-end
        },
      ],
    },
  },
};
```

## Pratiques recommand√©es {#recommended-practices}

### Versionner votre documentation uniquement lorsque c'est n√©cessaire {#version-your-documentation-only-when-needed}

Par exemple, vous cr√©ez une documentation pour votre paquet npm `foo` et vous √™tes actuellement √† la version 1.0.0. Vous publiez ensuite une version de patch pour une correction mineure, soit la version 1.0.1.

Faut-il cr√©er une nouvelle documentation version 1.0.1 ? **Vous ne devriez probablement pas**. Les version 1.0.1 et 1.0.0 ne devraient pas diff√©rer selon la gestion s√©mantique semver, car il n'y a pas de nouvelles fonctionnalit√©s ! Mettre en place cette nouvelle version ne fera que cr√©er des fichiers inutilement dupliqu√©s.

### Limitez le nombre de versions {#keep-the-number-of-versions-small}

En r√®gle g√©n√©rale, essayez de garder le nombre de vos versions en dessous de 10. Vous allez **tr√®s probablement** avoir beaucoup de documentation obsol√®te versionn√©e que personne ne lit plus. Par exemple, [Jest](https://jestjs.io/versions) est actuellement dans la version `27.4` et ne maintient uniquement que les derni√®res versions de la documentation, la plus basse √©tant `25.X`. Limitez les üòä

:::tip archive anciennes versions

Si vous d√©ployez votre site sur un fournisseur de Jamstack (par ex. Netlify), le fournisseur sauvegardera chaque version de production sous la forme d'un instantan√© sous une URL immuable. Vous pouvez inclure des versions archiv√©es qui ne seront jamais reconstruites en tant que liens externes vers ces URL immuables. Le site de Jest et le site Web de Docusaurus utilisent tous deux ce mod√®le pour r√©duire le nombre de versions activement construites.

:::

### Utiliser l'importation absolue dans la documentation {#use-absolute-import-within-the-docs}

N'utilisez pas de chemins relatifs √† l'importation dans la documentation. Parce que lorsque nous cr√©ons une version, les chemins ne fonctionnent plus (le niveau d'imbrication est diff√©rent, entre autres raisons). Vous pouvez utiliser l'alias `@site` fourni par Docusaurus qui pointe vers le r√©pertoire `website`. Exemple :

```diff
- import Foo from '../src/components/Foo';
+ import Foo from '@site/src/components/Foo';
```

### Liaison des documents par des chemins de fichiers {#link-docs-by-file-paths}

Faites r√©f√©rence √† d'autres documents par des chemins de fichiers relatifs avec l'extension `.md`, afin que Docusaurus puisse les r√©√©crire en chemins d'URL r√©els pendant la construction. Les fichiers seront li√©s √† la version correspondante.

```md
Le document [@hello](hello.mdx#paginate) est g√©nial !

Voir le [Tutoriel](../getting-started/tutorial.mdx) pour plus d'informations.
```

### Ressources colocalis√©es globalement ou versionn√©es {#global-or-versioned-collocated-assets}

Vous devez d√©cider si les ressources comme les images et les fichiers sont par version ou partag√©es entre les versions.

Si vos ressources doivent √™tre versionn√©s, mettez-les dans la version docs et utilisez des chemins relatifs¬†:

```md
![img alt](./myImage.png)

[download this file](./file.pdf)
```

Si vos ressources sont globales, mettez-les dans `/static` et utilisez des chemins absolus :

```md
![img alt](/myImage.png)

[download this file](/file.pdf)
```
