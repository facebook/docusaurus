---
slug: /versioning
---

# Gestion des versions

Vous pouvez utiliser la CLI de version pour crÃ©er une nouvelle version de documentation basÃ©e sur le contenu le plus rÃ©cent dans le rÃ©pertoire `docs`. Cet ensemble spÃ©cifique de documentation sera alors prÃ©servÃ© et accessible mÃªme lorsque la documentation dans le rÃ©pertoire `docs` continue d'Ã©voluer.

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

:::warning

Pensez-y avant de commencer Ã  versionner votre documentation - il peut devenir difficile pour les contributeurs de contribuer Ã  son amÃ©lioration !

:::

La plupart du temps, vous n'avez pas besoin de gestion des versions, car cela ne fait qu'augmenter le temps de construction et complexifier votre base de code. La gestion des versions est **plus adaptÃ©e aux sites web Ã  fort trafic et aux modifications rapides de la documentation entre les versions**. Si votre documentation change rarement, n'ajoutez pas de gestion de version Ã  votre documentation.

Pour mieux comprendre le fonctionnement de la gestion de version et voir s'il rÃ©pond Ã  vos besoins, vous pouvez lire ce qui suit.

## Vue d'ensemble {#overview}

Un site typique de doc versionnÃ© ressemble Ã  ce qui suitÂ :

```bash
website
â”œâ”€â”€ sidebars.json        # barre latÃ©rale pour la version courante
â”œâ”€â”€ docs                 # rÃ©pertoire docs pour la version courante
â”‚   â”œâ”€â”€ foo
â”‚   â”‚   â””â”€â”€ bar.md       # https://mysite.com/docs/next/foo/bar
â”‚   â””â”€â”€ hello.md         # https://mysite.com/docs/next/hello
â”œâ”€â”€ versions.json        # fichier pour indiquer quelles versions sont disponibles
â”œâ”€â”€ versioned_docs
â”‚   â”œâ”€â”€ version-1.1.0
â”‚   â”‚   â”œâ”€â”€ foo
â”‚   â”‚   â”‚   â””â”€â”€ bar.md   # https://mysite.com/docs/foo/bar
â”‚   â”‚   â””â”€â”€ hello.md
â”‚   â””â”€â”€ version-1.0.0
â”‚       â”œâ”€â”€ foo
â”‚       â”‚   â””â”€â”€ bar.md   # https://mysite.com/docs/1.0.0/foo/bar
â”‚       â””â”€â”€ hello.md
â”œâ”€â”€ versioned_sidebars
â”‚   â”œâ”€â”€ version-1.1.0-sidebars.json
â”‚   â””â”€â”€ version-1.0.0-sidebars.json
â”œâ”€â”€ docusaurus.config.js
â””â”€â”€ package.json
```

Le fichier `versions.json` est une liste de noms de version, ordonnÃ©e du plus rÃ©cent au plus ancien.

Le tableau ci-dessous explique comment un fichier versionnÃ© correspond Ã  sa version et Ã  l'URL gÃ©nÃ©rÃ©e.

| Chemin                                    | Version        | URL               |
| ----------------------------------------- | -------------- | ----------------- |
| `versioned_docs/version-1.0.0/hello.md`   | 1.0.0          | /docs/1.0.0/hello |
| `versioned_docs/version-1.1.0/hello.md`   | 1.1.0 (latest) | /docs/hello       |
| `docs/hello.md`                           | current        | /docs/next/hello  |

:::tip

Les fichiers dans le rÃ©pertoire `docs` appartiennent Ã  la version docs `current`.

Par dÃ©faut, la version de docs `current` est marquÃ©e comme `Next` et hÃ©bergÃ©e dans `/docs/next/*`, mais elle est entiÃ¨rement configurable pour correspondre au cycle de vie de votre projet.

:::

### Terminologie {#terminology}

Notez la terminologie que nous utilisons ici.

<dl>
  <dt>
    <b>Version actuelle</b>
  </dt>
  <dd>
    {'La version placÃ©e dans le rÃ©pertoire '}
    <code>./docs</code>
    {' .'}
  </dd>
  <dt>
    <b>DerniÃ¨re version</b>
  </dt>
  <dd>
    {'La version servie par dÃ©faut pour les Ã©lÃ©ments de la barre de navigation des docs. Habituellement a le chemin '}
    <code>/docs</code>
    {'.'}
  </dd>
</dl>

La version actuelle est dÃ©finie par **l'emplacement du systÃ¨me de fichiers**, alors que la derniÃ¨re version est dÃ©finie par **le comportement de navigation**. Il peut s'agir ou non de la mÃªme versionÂ ! (Et la configuration par dÃ©faut, comme indiquÃ© dans le tableau ci-dessus, les traiterait comme diffÃ©rentes : la version actuelle vers `/docs/next` et la derniÃ¨re vers `/docs`.)

## Tutoriels {#tutorials}

### Ã‰tiquetage d'une nouvelle version {#tagging-a-new-version}

1. Tout d'abord, assurez-vous que la version actuelle de la documentation (le rÃ©pertoire `./docs`) est prÃªte Ã  Ãªtre gelÃ©e.
2. Entrez un nouveau numÃ©ro de version.

```bash npm2yarn
npm run docusaurus docs:version 1.1.0
```

Lorsqu'on tague une nouvelle version, le mÃ©canisme de gestion des versions du document :

- Copie le contenu complet du dossier `docs/` dans un nouveau dossier `versioned_docs/version-[versionName]/`.
- CrÃ©e un fichier de barres latÃ©rales versionnÃ©es basÃ© sur la configuration de votre [barre latÃ©rale](./sidebar/index.mdx) actuelle (si elle existe) - enregistrÃ© sous `versioned_sidebars/version-[versionName]-sidebars.json`.
- Ajoute le nouveau numÃ©ro de version Ã  `versions.json`.

### CrÃ©ation de nouvelles docs {#creating-new-docs}

1. Placez le nouveau fichier dans le dossier de la version correspondante.
2. Ajoutez la rÃ©fÃ©rence du nouveau fichier dans le fichier de la barre latÃ©rale correspondante, selon le numÃ©ro de version.

```mdx-code-block
<Tabs>
<TabItem value="Structure de la version actuelle">
```

```bash
# Le fichier new.
docs/new.md

# Modifie le fichier correspondant Ã  la barre latÃ©rale.
sidebars.js
```

```mdx-code-block
</TabItem>
<TabItem value="Structure de l'ancienne version">
```

```bash
# Le fichier new.
versioned_docs/version-1.0.0/new.md

# Modifie le fichier correspondant Ã  la barre latÃ©rale.
versioned_sidebars/version-1.0.0-sidebars.json
```

```mdx-code-block
</TabItem>
</Tabs>
```

### Mise Ã  jour d'une version existante {#updating-an-existing-version}

Vous pouvez mettre Ã  jour plusieurs versions de docs en mÃªme temps car chaque rÃ©pertoire de `versioned_docs/` reprÃ©sente des routes spÃ©cifiques lorsqu'elles sont publiÃ©es.

1. Modifiez n'importe quel fichier.
2. Validez et soumettez les modifications.
3. Il sera publiÃ© dans la version.

Exemple: Lorsque vous changez n'importe quel fichier dans`versioned_docs/version-2.6/`, cela n'affectera que la documentation pour la version `2.6`.

### Suppression d'une version existante {#deleting-an-existing-version}

Vous pouvez Ã©galement supprimer/retirer des versions.

1. Retirez la version depuis le fichier `versions.json`.

Exemple :

```diff
[
  "2.0.0",
  "1.9.0",
  // highlight-next-line
- "1.8.0"
]
```

2. Supprimez le rÃ©pertoire de la documentation versionnÃ©e. ExempleÂ : `versioned_docs/version-1.8.0`.
3. Supprimez le fichier versionnÃ© de la barre latÃ©rale. ExempleÂ : `versioned_sidebars/version-1.8.0-sidebars.json`.

## Configuration du comportement des versions {#configuring-versioning-behavior}

La version Â«Â actuelleÂ Â» est le nom de la version de la documentation qui se trouve dans le dossier `./docs`. Il y a diffÃ©rentes maniÃ¨res de gÃ©rer les versions, mais les deux pratiques courantes sont :

- Vous publiez la v1 et commencez immÃ©diatement Ã  travailler sur la v2 (y compris sa documentation). Dans ce cas, la **version actuelle** est v2, qui se trouve dans le dossier source `./docs`, et peut Ãªtre parcouru via `example.com/docs/next`. La **derniÃ¨re version** est v1, qui est dans le dossier source `./versioned_docs/version-1`, et est parcouru par la plupart de vos utilisateurs via `example.com/docs`.
- Vous publiez la v1, et la maintiendrez pendant une certain temps avant de penser Ã  la v2. Dans ce cas, la **version actuelle** et la **derniÃ¨re version** pointeront vers v1, car la v2 des docs n'existe pas encoreÂ !

La configuration par dÃ©faut de Docusaurus fonctionnent trÃ¨s bien pour le premier cas d'utilisation. Nous allons Ã©tiqueter la version actuelle comme "next" et vous pouvez mÃªme choisir de ne pas la publier.

**Pour le 2nd cas** : si vous publiez la v1 et ne prÃ©voyez pas de travailler sur la v2 bientÃ´t, au lieu de versionner la v1 et d'avoir Ã  maintenir les fichiers dans deux dossiers (`./docs` + `./versioned_docs/version-1.0.0`), vous pouvez envisager de Â«Â prÃ©tendreÂ Â» que la version actuelle est une version dÃ©coupÃ©e en lui donnant un chemin et un libellÃ©Â :

```js title="docusaurus.config.js"
module.exports = {
  presets: [
    '@docusaurus/preset-classic',
    docs: {
      // highlight-start
      lastVersion: 'current',
      versions: {
        current: {
          label: '1.0.0',
          path: '1.0.0',
        },
      },
      // highlight-end
    },
  ],
};
```

Les docs dans `./docs` seront servis depuis `/docs/1.0.0` au lieu de `/docs/next` et `1.0.0` deviendra la version par dÃ©faut vers laquelle nous avons un lien dans le menu dÃ©roulant de la barre de navigation, et vous n'aurez besoin que de maintenir un seul dossier `./docs`.

Nous offrons ces options de plugin pour personnaliser le comportement des versionsÂ :

- `disableVersioning`Â : DÃ©sactive explicitement le versionnage mÃªme avec les versions. Ainsi, le site n'inclura que la version actuelle.
- `includeCurrentVersion`Â : Inclue la version actuelle (le dossier `./docs`) de vos docs.
  - **Astuce**Â : dÃ©sactivez-le si la version actuelle est en cours, pas prÃªte Ã  Ãªtre publiÃ©e.
- `lastVersion`Â : DÃ©finit Ã  quelle version la "derniÃ¨re version" (la route `/docs`) fait rÃ©fÃ©rence.
  - **Astuce**Â : `lastVersion: 'current'` a un sens si votre version actuelle fait rÃ©fÃ©rence Ã  une version majeure constamment corrigÃ©e et publiÃ©e. Le chemin de base et le libellÃ© de la derniÃ¨re version sont configurables.
- `onlyIncludeVersions`Â : DÃ©finit un sous-ensemble de versions de `versions.json` Ã  dÃ©ployer.
  - **Astuce**Â : limitez Ã  2 ou 3 versions en dev et dÃ©ployez des aperÃ§us pour amÃ©liorer le temps de dÃ©marrage et de compilation.
- `versions`Â : Un dictionnaire de mÃ©tadonnÃ©es de version. Pour chaque version, vous pouvez personnaliser les Ã©lÃ©ments suivantsÂ :
  - `label`Â : le libellÃ© affichÃ© dans le menu dÃ©roulant des versions et la banniÃ¨re.
  - `path`Â : le chemin de base de la route de cette version. Par dÃ©faut, la derniÃ¨re version a `/` et la version actuelle a `/next`.
  - `banner`Â : l'une des valeurs suivantes 'none', 'unreleased' et 'unmaintained'\`. DÃ©termine ce qui est affichÃ© en haut de chaque page de documentation. Toute version supÃ©rieure Ã  la derniÃ¨re version serait "unreleased", et toute version infÃ©rieure serait "unmaintained".
  - `badge`Â : montre un badge avec le nom de version en haut d'un doc de cette version.
  - `className`Â : ajoute un `className` personnalisÃ© Ã  l'Ã©lÃ©ment `<html>` aux pages de doc de cette version.

Consultez la [configuration du plugin des docs](../../api/plugins/plugin-content-docs.mdx#configuration) pour plus de dÃ©tails.

## Ã‰lÃ©ments de la barre de navigation {#navbar-items}

Nous offrons plusieurs Ã©lÃ©ments de la barre de navigation pour vous aider Ã  configurer rapidement la navigation sans vous soucier des routes versionnÃ©es.

- [`doc`](../../api/themes/theme-configuration.mdx#navbar-doc-link)Â : un lien vers un doc.
- [`docSidebar`](../../api/themes/theme-configuration.mdx#navbar-doc-sidebar)Â : un lien vers le premier Ã©lÃ©ment d'une barre latÃ©rale.
- [`docsVersion`](../../api/themes/theme-configuration.mdx#navbar-docs-version)Â : un lien vers le doc principal de la version actuellement consultÃ©e.
- [`docsVersionDropdown`](../../api/themes/theme-configuration.mdx#navbar-docs-version-dropdown)Â : un menu dÃ©roulant contenant toutes les versions disponibles.

Ces liens rechercheront tous une version appropriÃ©e Ã  laquelle se rattacher, dans l'ordre suivantÂ :

1. **Version active**Â : la version sur laquelle l'utilisateur navigue actuellement, si elle se trouve sur une page fournie par ce plugin de doc. Si elle n'est pas sur une page de doc, elle se rabat sur la...
2. **Version prÃ©fÃ©rÃ©e**Â : la version que l'utilisateur a consultÃ©e pour la derniÃ¨re fois. S'il n'y a pas d'historique, elle se rabat sur la...
3. **DerniÃ¨re version**Â : la version par dÃ©faut vers laquelle nous naviguons, configurÃ©e par l'option `lastVersion`.

## Pratiques recommandÃ©es {#recommended-practices}

### Versionnez votre documentation uniquement lorsque c'est nÃ©cessaire {#version-your-documentation-only-when-needed}

Par exemple, vous crÃ©ez une documentation pour votre paquet npm `foo` et vous Ãªtes actuellement Ã  la version 1.0.0. Vous publiez ensuite une version de patch pour une correction mineure, soit la version 1.0.1.

Faut-il crÃ©er une nouvelle documentation version 1.0.1 ? **Vous ne devriez probablement pas**. Les version 1.0.1 et 1.0.0 ne devraient pas diffÃ©rer selon la gestion sÃ©mantique semver, car il n'y a pas de nouvelles fonctionnalitÃ©s ! Mettre en place cette nouvelle version ne fera que crÃ©er des fichiers inutilement dupliquÃ©s.

### Limitez le nombre de versions {#keep-the-number-of-versions-small}

En rÃ¨gle gÃ©nÃ©rale, essayez de garder le nombre de vos versions en dessous de 10. Vous allez **trÃ¨s probablement** avoir beaucoup de documentation obsolÃ¨te versionnÃ©e que personne ne lit plus. Par exemple, [Jest](https://jestjs.io/versions) est actuellement dans la version `27.4` et ne maintient uniquement que les derniÃ¨res versions de la documentation, la plus basse Ã©tant `25.X`. Limitez les ğŸ˜Š

:::tip archiver les anciennes versions

Si vous dÃ©ployez votre site sur un fournisseur de Jamstack (par exemple [Netlify](../../deployment.mdx)), le fournisseur sauvegardera chaque version de production en tant qu'instantanÃ© sous une URL immuable. Vous pouvez inclure des versions archivÃ©es qui ne seront jamais reconstruites en tant que liens externes vers ces URL immuables. Le site de Jest et le site Web de Docusaurus utilisent tous deux ce modÃ¨le pour rÃ©duire le nombre de versions activement construites.

:::

### Utilisez l'importation absolue dans la documentation {#use-absolute-import-within-the-docs}

N'utilisez pas de chemins relatifs Ã  l'importation dans la documentation. Parce que lorsque nous crÃ©ons une version, les chemins ne fonctionnent plus (le niveau d'imbrication est diffÃ©rent, entre autres raisons). Vous pouvez utiliser l'alias `@site` fourni par Docusaurus qui pointe vers le rÃ©pertoire `website`. Exemple :

```diff
- import Foo from '../src/components/Foo';
+ import Foo from '@site/src/components/Foo';
```

### Liez des documents par des chemins de fichiers {#link-docs-by-file-paths}

Faites rÃ©fÃ©rence Ã  d'autres documents par des chemins de fichiers relatifs avec l'extension `.md`, afin que Docusaurus puisse les rÃ©Ã©crire en chemins d'URL rÃ©els pendant la construction. Les fichiers seront liÃ©s Ã  la version correspondante.

```md
Le document [@hello](hello.mdx#paginate) est gÃ©nialÂ !

Voir le [Tutoriel](../getting-started/tutorial.mdx) pour plus d'informations.
```

### Ressources colocalisÃ©es globalement ou versionnÃ©es {#global-or-versioned-collocated-assets}

Vous devez dÃ©cider si les ressources comme les images et les fichiers sont par version ou partagÃ©es entre les versions.

Si vos ressources doivent Ãªtre versionnÃ©s, mettez-les dans la version docs et utilisez des chemins relatifsÂ :

```md
![img alt](./myImage.png)

[download this file](./file.pdf)
```

Si vos ressources sont globales, mettez-les dans `/static` et utilisez des chemins absolus :

```md
![img alt](/myImage.png)

[download this file](/file.pdf)
```
