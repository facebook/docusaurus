---
title: Annonce de Docusaurus 3.0
authors:
  - slorber
tags:
  - version
image: ./img/social-card.png
date: 2023-10-31
---

Aujourd'hui, nous sommes heureux d'**annoncer Docusaurus 3.0**¬†! ü•≥

Chez [**Meta Open Source**](https://opensource.fb.com/), nous pensons que Docusaurus vous aidera √† construire les **meilleurs sites web de documentation** avec **un minimum d'effort**, vous permettant de **vous concentrer sur ce qui compte vraiment**¬†: l'√©criture du contenu.

Il s'agit d'une nouvelle **version majeure** de Docusaurus, avec **de nouvelles fonctionnalit√©s int√©ressantes** et des d√©pendances mises √† jour.

Conform√©ment aux principes du [**Semantic Versioning**](https://semver.org/), cette version inclut des **changements de rupture** que nous avons document√©s en d√©tail dans le [**guide de mise √† jour de la version 3**](/docs/migration/v3/). Les changements de rupture peuvent √™tre g√™nants, mais ils sont n√©cessaires pour pr√©parer le terrain √† une **nouvelle vague de fonctionnalit√©s Docusaurus** que nous pr√©voyons d'impl√©menter.

![image de carte sociale v3.0](./img/social-card.png)

{/_ truncate _/}

Nous avions initialement pr√©vu de publier des versions majeures plus fr√©quemment, mais Docusaurus v3 a pris plus de temps que pr√©vu. Parmi les changements de rupture que nous avons comptabilis√©s, **la mont√©e de version vers MDX v3** est probablement le principal d√©fi √† l'adoption de cette nouvelle version. Nous avons fait un effort suppl√©mentaire pour rendre cette mont√©e de version aussi facile que possible, notamment en ajoutant des [options de compatibilit√© pour MDX v1](/docs/api/docusaurus-config#markdown).

Les sites les plus simples n'auront besoin de mettre √† jour que quelques d√©pendances npm. Pour les sites plus complexes, nous avons √©labor√© quelques strat√©gies qui peuvent vous aider √† effectuer une mise √† niveau en toute confiance¬†:

- [Pr√©parez votre site](/blog/preparing-your-site-for-docusaurus-v3) √† l'avance, progressivement, tout en restant sur Docusaurus v2
- [Mettez en place des tests de r√©gression visuelle](/blog/upgrading-frontend-dependencies-with-confidence-using-visual-regression-testing) pour d√©tecter les changements visuels inattendus survenant au cours de la mise √† jour

:::info √Ä propos de Docusaurus v2

According to our [release process](/community/release-process), Docusaurus v2 has now entered **maintenance mode**. Elle b√©n√©ficiera d'une assistance pour les probl√®mes de s√©curit√© majeurs pendant trois mois seulement, jusqu'au 31 janvier 2024. Il est recommand√© de passer √† la version 3 dans ce laps de temps.

:::

import IframeWindow from '@site/src/components/BrowserWindow/IframeWindow';

## Changements de rupture

Cette section ne donne qu'un bref aper√ßu. Toutes les changements de rupture sont document√©s en d√©tail dans le [**guide de mise √† jour de la version 3**](/docs/migration/v3).

Docusaurus v3 a mis √† jour quelques d√©pendances vers de nouvelles versions majeures, chacune venant avec ses propres changements de rupture¬†:

- Node.js v16 ‚û°Ô∏è v18
- React v17 ‚û°Ô∏è v18
- MDX v1 ‚û°Ô∏è v3
- TypeScript v4 ‚û°Ô∏è v5
- prism-react-renderer v1 ‚û°Ô∏è v2
- react-live v2 ‚û°Ô∏è v4
- Mermaid v9 ‚û°Ô∏è v10
- import-fresh v3 ‚û°Ô∏è jiti v1
- remark-emoji v2 ‚û°Ô∏è v4

Une mise √† jour typique des d√©pendances de `package.json` ressemble √† ceci¬†:

```diff title="package.json"
 {
   "dependencies": {
     // upgrade to Docusaurus v3
-    "@docusaurus/core": "2.4.3",
-    "@docusaurus/preset-classic": "2.4.3",
+    "@docusaurus/core": "3.0.0",
+    "@docusaurus/preset-classic": "3.0.0",
     // upgrade to MDX v3
-    "@mdx-js/react": "^1.6.22",
+    "@mdx-js/react": "^3.0.0",
     // upgrade to prism-react-renderer v2.0+
-    "prism-react-renderer": "^1.3.5",
+    "prism-react-renderer": "^2.1.0",
     // upgrade to React v18.0+
-    "react": "^17.0.2",
-    "react-dom": "^17.0.2"
+    "react": "^18.2.0",
+    "react-dom": "^18.2.0"
   },
   "devDependencies": {
     // upgrade Docusaurus dev dependencies to v3
-    "@docusaurus/module-type-aliases": "2.4.3",
-    "@docusaurus/types": "2.4.3"
+    "@docusaurus/module-type-aliases": "3.0.0",
+    "@docusaurus/types": "3.0.0"
   }
   "engines": {
     // require Node.js 18.0+
-    "node": ">=16.14"
+    "node": ">=18.0"
   }
 }
```

A l'exception de MDX v3, la plupart des changements de rupture provenant de ces d√©pendances, qui ont √©t√© mises √† jour, ont √©t√© g√©r√©s en interne pour vous : la plupart du temps, vous ne devriez pas avoir √† faire quoi que ce soit. En dehors des d√©pendances, les seuls changements de rupture fonctionnels provenant explicitement de la base de code de Docusaurus sont les suivantes¬†:

- [#9189](https://github.com/facebook/docusaurus/pull/9189)¬†: nouveau flux RSS de blog par d√©faut limit√© √† 20 entr√©es
- [#9308](https://github.com/facebook/docusaurus/pull/9308)¬†: corrige et r√©introduit l'admonition `:::warning`, supprime `:::caution`
- [#9310](https://github.com/facebook/docusaurus/pull/9310)¬†: supprime l'ancien pr√©fixe d'identification de la barre lat√©rale, utilis√© pour les sites dont la version est ant√©rieure √† `v2.0.0-beta.10` (d√©cembre 2021)
- [#7966](https://github.com/facebook/docusaurus/pull/7966)¬†: refactorise les composants du th√®me des docs, ce qui vous oblige √©ventuellement √† les re-swizzler

## Points importants

Voici une liste non exhaustive des nouvelles fonctionnalit√©s utiles de cette nouvelle version. Toutes les fonctionnalit√©s sont list√©es dans les [**notes de version de Docusaurus v3.0.0**](https://github.com/facebook/docusaurus/releases/tag/v3.0.0).

### Markdown

Docusaurus v3 met √† jour MDX v1 en MDX v3¬†:

- dans [#8288](https://github.com/facebook/docusaurus/pull/8288), nous avons mis √† jour vers [**MDX v2**](https://mdxjs.com/blog/v2/) ([guide de migration](https://mdxjs.com/migrating/v2/))
- dans [#9451](https://github.com/facebook/docusaurus/pull/9451), nous avons mis √† jour vers [**MDX v3**](https://mdxjs.com/blog/v3/) ([guide de migration](https://mdxjs.com/migrating/v3/))

Cette nouvelle version de MDX est **bien meilleure pour les r√©dacteurs de contenu et les auteurs de plugins**, et pr√©pare le terrain pour l'impl√©mentation de nouvelles fonctionnalit√©s Markdown passionnantes.

:::warning MDX v3 - le principal d√©fi

La transition de MDX v1 √† MDX v3 est le **principal d√©fi** pour le passage √† Docusaurus v3.

Certains documents qui ont √©t√© compil√©s avec succ√®s sous Docusaurus v2 peuvent maintenant **ne pas √™tre compil√©s** sous Docusaurus v3, tandis que d'autres peuvent **s'afficher diff√©remment**.

La plupart des changements de rupture proviennent de [MDX v2(https://mdxjs.com/blog/v2/), et [MDX v3(https://mdxjs.com/blog/v3/) qui est une version relativement petite. Le [guide de migration MDX v2](https://mdxjs.com/migrating/v2/) contient une section sur la fa√ßon de [mettre √† jour les fichiers MDX](https://mdxjs.com/migrating/v2/#update-mdx-files) qui sera particuli√®rement pertinente pour nous. Assurez-vous √©galement de lire la page [Troubleshooting MDX](https://mdxjs.com/docs/troubleshooting-mdx/) qui peut vous aider √† interpr√©ter les messages d'erreur MDX les plus courants.

**Ne soyez pas intimid√©**. La plupart des probl√®mes sont **faciles √† r√©soudre** et souvent li√©s aux caract√®res `{` et `<` que vous devez maintenant √©chapper. Cependant, en fonction de la taille de votre site, vous pourriez avoir besoin de modifier de nombreux fichiers et vous sentir submerg√©. Pour cette raison, nous fournissons une commande [`npx docusaurus-mdx-checker`](https://github.com/slorber/docusaurus-mdx-checker) pour vous aider √† obtenir une estimation du travail √† effectuer, et nous recommandons de [pr√©parer votre site √† l'avance](/blog/preparing-your-site-for-docusaurus-v3).

Si vous avez cr√©√© des [plugins MDX](/docs/markdown-features/plugins) (Remark/Rehype), l'AST est l√©g√®rement diff√©rent et vous devrez peut-√™tre les refactoriser.

:::

Cela nous permet notamment d'ajouter un [mode CommonMark](/docs/markdown-features#mdx-vs-commonmark) qui devrait faciliter l'adoption de Docusaurus pour les documentations existantes. Elle est actuellement facultative, **exp√©rimentale** et limit√©e ([certaines fonctionnalit√©s de Docusaurus ne fonctionneront pas](https://github.com/facebook/docusaurus/issues/9092)). Dans Docusaurus v3, tous les fichiers sont encore interpr√©t√©s en MDX, mais nous pr√©voyons d'interpr√©ter les fichiers `.md` en CommonMark dans une prochaine version majeure, et nous recommandons d'utiliser l'extension `.mdx` pour tout fichier utilisant les modules JSX ou ES.

Nous avons √©galement introduit une nouvelle fa√ßon de [configurer le Markdown globalement pour votre site](/docs/api/docusaurus-config#markdown), et nous pr√©voyons d'ajouter des options plus flexibles ult√©rieurement.

```js title="docusaurus.config.js"
export default {
  markdown: {
    format: 'mdx',
    mermaid: true,
    preprocessor: ({filePath, fileContent}) => {
      return fileContent.replaceAll('{{MY_VAR}}', 'MY_VALUE');
    },
    mdx1Compat: {
      comments: true,
      admonitions: true,
      headingIds: true,
    },
  },
};
```

Docusaurus utilise d√©sormais le plugin [remark-directive](https://github.com/remarkjs/remark-directive) pour prendre en charge les admonitions. Cela vous offre √©galement la possibilit√© de cr√©er vos propres plugins Remark pour √©tendre Markdown avec vos propres [directives personnalis√©es](https://talk.commonmark.org/t/generic-directives-plugins-syntax/444) telles que `:textDirective`, `::leafDirective` ou `:::containerDirective`.

### Configs ESM et TypeScript {#esm-ts-configs}

Dans [#9317](https://github.com/facebook/docusaurus/pull/9317), nous avons ajout√© la prise en charge des modules ES et des fichiers de config TypeScript, y compris la config du site, les barres lat√©rales des docs, les plugins et les presets.

Voici 2 exemples TypeScript, vous donnant une exp√©rience moderne avec l'autocompl√©tion de l'IDE¬†:

```ts title="docusaurus.config.ts"
import type {Config} from '@docusaurus/types';
import type * as Preset from '@docusaurus/preset-classic';

const config: Config = {
  title: 'Mon Site',
  favicon: 'img/favicon.ico',
  // Votre config de site ...
  presets: [
    [
      'classic',
      {
        // Votre config de preset ...
      } satisfies Preset.Options,
    ],
  ],
  themeConfig: {
    // Votre config de th√®me ...
  } satisfies Preset.ThemeConfig,
};

export default config;
```

```ts title="sidebars.ts"
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';

const sidebars: SidebarsConfig = {
  docs: ['introduction'],
};

export default sidebars;
```

### Contenu non list√©

Docusaurus prenait d√©j√† en charge l'option `draft : true` dans nos 3 plugins de contenu (docs, blog, pages), ce qui vous permet de supprimer certaines pages de vos versions de production.

Dans [#8004](https://github.com/facebook/docusaurus/pull/8004), nous avons introduit une nouvelle option `unlisted : true`, qui gardera vos pages disponibles dans les constructions de production, tout en les ¬´ cachant ¬ª et en les rendant impossibles √† d√©couvrir √† moins que vous n'ayez l'url. Cela permet de mettre en place des flux de travail utiles o√π vous pouvez facilement demander un avis sur un √©l√©ment de contenu avant la publication finale.

Le contenu non list√© sera¬†:

- exclu de `sitemap.xml`
- exclu des r√©sultats de r√©f√©rencement gr√¢ce √† `<meta name="robots" content="noindex, nofollow" />`
- exclu des flux RSS du blog
- exclu des r√©sultats d'Algolia DocSearch
- filtr√© √† partir des √©l√©ments de la barre de navigation du site, des barres lat√©rales des docs, de la barre lat√©rale du blog, des archives du blog, des tags des pages...

Les contenus non list√©s affichent √©galement une banni√®re afin que vous n'oubliiez pas de la d√©sactiver une fois que votre contenu est pr√™t pour le grand jour. Voici un exemple d'[article du blog non list√©](/tests/blog/unlisted-post)¬†:

<IframeWindow url="/tests/blog/unlisted-post" />

### React 18

Dans [#8961](https://github.com/facebook/docusaurus/pull/8961), nous avons fait la mise √† jour vers React 18. C'est important, notamment pour [l'adoption progressive des fonctionnalit√©s Concurrent de React](https://react.dev/blog/2022/03/29/react-v18#gradually-adopting-concurrent-features), ainsi que pour les fonctionnalit√©s prometteuses √† venir telles que [les composants de serveur React √† l'ex√©cution de la construction](https://github.com/facebook/docusaurus/issues/9089).

Cette nouvelle version de React devrait pouvoir remplacer la plupart des sites Docusaurus. Elle s'accompagne de changements de rupture que nous avons g√©r√©s en interne dans la base de code de Docusaurus. Si votre site utilise beaucoup de code React personnalis√©, nous vous recommandons de consulter l'article officiel sur [Comment passer √† React 18](https://react.dev/blog/2022/03/08/react-18-upgrade-guide), notamment le nouveau comportement de [batching automatique](https://react.dev/blog/2022/03/08/react-18-upgrade-guide#automatic-batching).

:::danger Prise en charge exp√©rimentale des fonctionnalit√©s de React 18

React 18 est livr√© avec de nouvelles fonctionnalit√©s¬†:

- `<Suspense>`
- `React.lazy()`
- `startTransition()`

Leur prise en charge par Docusaurus est consid√©r√©e comme **exp√©rimentale**. Nous pourrions √™tre amen√©s √† ajuster l'int√©gration √† l'avenir, ce qui entra√Ænerait un comportement diff√©rent au niveau de l'ex√©cution.

:::

### Ex√©cution automatique du JSX

Docusaurus v3 utilise d√©sormais le [runtime JSX ¬´¬†automatique¬†¬ª](https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html).

Il n'est plus n√©cessaire d'importer React dans les fichiers JSX qui n'utilisent aucune API React.

```diff title="src/components/MyComponent.js"
- import React from 'react';

  export default function MyComponent() {
    return <div>Hello</div>;
  }
```

### D√©bogage des constructions

Il est maintenant possible de construire votre site statique en mode dev.

```bash
docusaurus build --dev
```

:::tip D√©boguer les probl√®mes li√©s √† React

Docusaurus enregistrera plus d'erreurs dans la console, notamment les erreurs d'hydratation de React 18 gr√¢ce au nouveau callback [`onRecoverableError`](https://react.dev/reference/react-dom/client/hydrateRoot#parameters).

Ce nouveau mode de compilation est particuli√®rement utile pour **r√©soudre les probl√®mes de React**. Docusaurus utilisera la version de d√©veloppement de React, produisant ainsi des messages d'erreur d√©taill√©s et lisibles au lieu de messages minifi√©s renvoyant √† la [page du d√©codeur d'erreurs React](https://reactjs.org/docs/error-decoder.html/).

:::

### TypeScript

Docusaurus v3 n√©cessite maintenant une version minimale de TypeScript 5.0.

Nous avons r√©internalis√© la config TypeScript de base recommand√©e dans un nouveau package officiel¬†:

```diff title="tsconfig.json"
 {
-  "extends": "@tsconfig/docusaurus/tsconfig.json",
+  "extends": "@docusaurus/tsconfig",
   "compilerOptions": {
     "baseUrl": "."
   }
 }
```

Nous avons √©galement des exportations plus propres et normalis√©es pour le type du noyau de Docusaurus, les plugins et les options de preset, que vous pouvez utiliser dans les tous nouveaux [fichiers de configuration TypeScript](#esm-ts-configs)¬†:

```ts title="docusaurus.config.ts"
import type {Config} from '@docusaurus/types';
import type {Options, ThemeConfig} from '@docusaurus/preset-classic';
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';
```

### Blocs de code

Dans [#9316](https://github.com/facebook/docusaurus/pull/9316), nous avons am√©lior√© la coloration syntaxique gr√¢ce √† la mise √† jour de [prism-react-renderer](https://github.com/FormidableLabs/prism-react-renderer) v2. Par exemple, le param√®tre bash `--save` est maintenant coloris√©¬†:

```bash
npm install --save some-package
```

L'[√©diteur de code interactif](/docs/markdown-features/code-blocks#interactive-code-editor) passe √©galement √† [react-live](https://github.com/FormidableLabs/react-live) v4, avec un nouveau compilateur [sucrase](https://github.com/alangpierce/sucrase). Il est plus rapide, plus l√©ger et prend en charge des fonctionnalit√©s modernes, notamment les annotations de type TypeScript.

```js live
function Hello() {
  const name: string = 'World';
  return <div>Hello {name}</div>;
}
```

Dans [#8982](https://github.com/facebook/docusaurus/pull/8982) et [#8870](https://github.com/facebook/docusaurus/pull/8870), nous avons √©galement ajout√© la prise en charge des [commentaires magiques](/docs/markdown-features/code-blocks#custom-magic-comments) pour les syntaxes de commentaires de type TeX, Haskell et WebAssembly.

```haskell title="haskell.hs"
stringLength :: String -> Int
-- highlight-next-line
stringLength [] = 0
stringLength (x:xs) = 1 + stringLength xs
```

```matlab title="matlab.m"
% highlight-start
function result = times2(n)
  result = n * 2;
end
% highlight-end
x = 10;
% highlight-next-line
y = times2(x);
```

### Diagrammes Mermaid

Dans [#9305](https://github.com/facebook/docusaurus/pull/9305), nous avons mis √† jour Mermaid v10.4 et ajout√© la prise en charge du rendu asynchrone des diagrammes. Docusaurus est maintenant en mesure de rendre de nouveaux types de diagrammes.

<details>
  <summary>Carte mentale</summary>

```mermaid
mindmap
  root((Carte mentale))
    Recherche
      Techniques cr√©atives
      Planification strat√©gique
      Correspondance des arguments
    Outils
      Crayon et papier
      Mermaid
```

</details>

<details>
  <summary>Graphique en quadrant</summary>

```mermaid
quadrantChart
  title Port√©e et implication des campagnes
  x-axis Faible port√©e --> Haute port√©e
  y-axis Faible implication --> Forte implication
  quadrant-1 Nous devrions d√©velopper
  quadrant-2 Besoin de promouvoir
  quadrant-3 A r√©√©valuer
  quadrant-4 Peut √™tre am√©lior√©
  Campagne A: [0.3, 0.6]
  Campagne B: [0.45, 0.23]
  Campagne C: [0.57, 0.69]
  Campagne D: [0.78, 0.34]
  Campagne E: [0.40, 0.34]
  Campagne F: [0.35, 0.78]
```

</details>

### Attributs de donn√©es de la cha√Æne de requ√™te

Dans [#9028](https://github.com/facebook/docusaurus/pull/9028), nous avons rendu possible la d√©finition d'[attributs de donn√©es](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/data-*) HTML personnalis√©s √† travers les param√®tres de la cha√Æne de requ√™te `docusaurus-data-x`. Cela facilite l'int√©gration d'un iframe Docusaurus sur un autre site et vous permet de personnaliser l'apparence de la version int√©gr√©e √† l'aide de CSS.

```css title="/src/css/custom.css"
html[data-navbar='false'] .navbar {
  display: none;
}

html[data-red-border] div#__docusaurus {
  border: red solid thick;
}
```

<IframeWindow url="/docs/?docusaurus-data-navbar=false&docusaurus-data-red-border" />

### Autres fonctionnalit√©s

Autres nouvelles fonctionnalit√©s √† mentionner¬†:

- [#9189](https://github.com/facebook/docusaurus/pull/9189)¬†: nouvelle option du blog `feedOptions.limit`
- [#9071](https://github.com/facebook/docusaurus/pull/9071)¬†: ajout d'un support de r√©f√©rencement normalis√© pour le plugin de pages
- [#9171](https://github.com/facebook/docusaurus/pull/9028)¬†: le plugin client-redirects prend d√©sormais en charge les urls qualifi√©s et query-string/hash dans l'url de destination
- [#9171](https://github.com/facebook/docusaurus/pull/9171)¬†: nouvelle r√®gle ESLint [`no-html-links`](/docs/api/misc/@docusaurus/eslint-plugin/no-html-links)
- [#8384](https://github.com/facebook/docusaurus/pull/8384)¬†: nouvelle r√®gle ESLint [`prefer-docusaurus-heading`](/docs/api/misc/@docusaurus/eslint-plugin/prefer-docusaurus-heading)

Consultez les [**notes de version de Docusaurus v3.0.0**](https://github.com/facebook/docusaurus/releases/tag/v3.0.0) pour une liste exhaustive des changements.

## Conclusion

Cette version est fournie avec quelques fonctionnalit√©s, mais plus important encore, **met √† jour de nombreuses pi√®ces de l'infrastructure Docusaurus**.

La **mise √† jour MDX** a consomm√© beaucoup de notre temps cette ann√©e, et nous avons travaill√© dur pour rendre cette importante mise √† jour moins difficile pour vous tous.

Maintenant que nous avons rattrap√© notre retard en mati√®re d'infrastructure, nous serons de retour pour **d√©livrer des fonctionnalit√©s de documentation utiles** tr√®s bient√¥t, dans les prochaines versions mineures.

Nous vous remercions d'utiliser Docusaurus au fil des ans. Le march√© des frameworks de documentation devient de plus en plus concurrentiel ces derniers temps, et nous ferons de notre mieux pour que Docusaurus reste une **solution comp√©titive** qui se distingue par sa grande **flexibilit√©**.
