---
slug: /versioning
---

# åˆ†ç‰ˆ

You can use the versioning CLI to create a new documentation version based on the latest content in the `docs` directory. That specific set of documentation will then be preserved and accessible even as the documentation in the `docs` directory continues to evolve.

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

:::warning

åœ¨ç»™ä½ çš„æ–‡æ¡£åˆ’åˆ†ç‰ˆæœ¬ä¹‹å‰ï¼Œè¯·ä¸‰æ€â€”â€”è´¡çŒ®è€…å¯èƒ½ä¼šæ›´éš¾å¸®åŠ©æ”¹è¿›æ–‡æ¡£ï¼

:::

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦åˆ’åˆ†æ–‡æ¡£ç‰ˆæœ¬ï¼Œè¿™æ ·ä¸ä»…ä¼šå»¶é•¿æ„å»ºæ—¶é—´ï¼Œè¿˜ä¼šæŠŠä½ çš„ä»£ç å¤æ‚åŒ–ã€‚ Versioning is **best suited for websites with high-traffic and rapid changes to documentation between versions**. å¦‚æœä½ çš„æ–‡æ¡£å¾ˆå°‘æ›´æ”¹ï¼Œè¯·ä¸è¦ç»™ä½ çš„æ–‡æ¡£åˆ’åˆ†ç‰ˆæœ¬ã€‚

ä¸ºäº†æ·±å…¥äº†è§£ç‰ˆæœ¬åŒ–æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œå¹¶æŸ¥çœ‹å®ƒæ˜¯å¦ç¬¦åˆä½ çš„éœ€è¦ï¼Œä½ å¯ä»¥ç»§ç»­é˜…è¯»ä¸‹æ–‡ã€‚

## Overview {#overview}

å…¸å‹çš„ç‰ˆæœ¬åŒ–æ–‡æ¡£ç½‘ç«™å¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
website
â”œâ”€â”€ sidebars.json        # å½“å‰æ–‡æ¡£ç‰ˆæœ¬çš„ä¾§è¾¹æ 
â”œâ”€â”€ docs                 # å½“å‰æ–‡æ¡£ç‰ˆæœ¬çš„æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ foo
â”‚   â”‚   â””â”€â”€ bar.md       # https://mysite.com/docs/next/foo/bar
â”‚   â””â”€â”€ hello.md         # https://mysite.com/docs/next/hello
â”œâ”€â”€ versions.json        # è¡¨æ˜å“ªäº›ç‰ˆæœ¬å¯ç”¨çš„æ–‡ä»¶
â”œâ”€â”€ versioned_docs
â”‚   â”œâ”€â”€ version-1.1.0
â”‚   â”‚   â”œâ”€â”€ foo
â”‚   â”‚   â”‚   â””â”€â”€ bar.md   # https://mysite.com/docs/foo/bar
â”‚   â”‚   â””â”€â”€ hello.md
â”‚   â””â”€â”€ version-1.0.0
â”‚       â”œâ”€â”€ foo
â”‚       â”‚   â””â”€â”€ bar.md   # https://mysite.com/docs/1.0.0/foo/bar
â”‚       â””â”€â”€ hello.md
â”œâ”€â”€ versioned_sidebars
â”‚   â”œâ”€â”€ version-1.1.0-sidebars.json
â”‚   â””â”€â”€ version-1.0.0-sidebars.json
â”œâ”€â”€ docusaurus.config.js
â””â”€â”€ package.json
```

The `versions.json` file is a list of version names, ordered from newest to oldest.

ä¸‹è¡¨è§£é‡Šäº†ç‰ˆæœ¬åŒ–çš„æ–‡ä»¶æ˜¯å¦‚ä½•ä»ç‰ˆæœ¬æ˜ å°„åˆ°ç”Ÿæˆçš„ URL çš„ã€‚

| è·¯å¾„                                      | ç‰ˆæœ¬             | URL               |
| --------------------------------------- | -------------- | ----------------- |
| `versioned_docs/version-1.0.0/hello.md` | 1.0.0          | /docs/1.0.0/hello |
| `versioned_docs/version-1.1.0/hello.md` | 1.1.0ï¼ˆæœ€æ–°ï¼‰      | /docs/hello       |
| `docs/hello.md`                         | current        | /docs/next/hello  |

:::tip

The files in the `docs` directory belong to the `current` docs version.

By default, the `current` docs version is labeled as `Next` and hosted under `/docs/next/*`, but it is entirely configurable to fit your project's release lifecycle.

:::

### Terminology {#terminology}

è¯·æ³¨æ„æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æœ¯è¯­ã€‚

<dl>
  <dt>
    <b>Current version</b>
  </dt>
  <dd>
    {'The version placed in the '}
    <code>./docs</code>
    {' folder.'}
  </dd>
  <dt>
    <b>Latest version / last version</b>
  </dt>
  <dd>
    {'The version served by default for docs navbar items. Usually has path '}
    <code>/docs</code>
    {'.'}
  </dd>
</dl>

Current version is defined by the **file system location**, while latest version is defined by the **the navigation behavior**. å®ƒä»¬å¯èƒ½æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬ï¼ (And the default configuration, as shown in the table above, would treat them as different: current version at `/docs/next` and latest at `/docs`.)

## Tutorials {#tutorials}

### Tagging a new version {#tagging-a-new-version}

1. First, make sure the current docs version (the `./docs` directory) is ready to be frozen.
2. è¾“å…¥æ–°çš„ç‰ˆæœ¬å·ã€‚

```bash npm2yarn
npm run docusaurus docs:version 1.1.0
```

æ ‡è®°æ–°ç‰ˆæœ¬æ—¶ï¼Œæ–‡æ¡£åˆ†ç‰ˆæœºåˆ¶ä¼šï¼š

- Copy the full `docs/` folder contents into a new `versioned_docs/version-[versionName]/` folder.
- Create a versioned sidebars file based from your current [sidebar](./sidebar/index.mdx) configuration (if it exists) - saved as `versioned_sidebars/version-[versionName]-sidebars.json`.
- Append the new version number to `versions.json`.

### Creating new docs {#creating-new-docs}

1. æŠŠæ–°æ–‡ä»¶æ”¾åœ¨ç›¸åº”ç‰ˆæœ¬çš„æ–‡ä»¶å¤¹ä¸­ã€‚
2. æ ¹æ®ç‰ˆæœ¬å·ï¼Œåœ¨ç›¸åº”çš„ä¾§è¾¹æ æ–‡ä»¶ä¸­æ·»åŠ æ–°æ–‡ä»¶çš„å¼•ç”¨ã€‚

```mdx-code-block
<Tabs>
<TabItem value="Current version structure">
```

```bash
# The new file.
docs/new.md

# Edit the corresponding sidebar file.
sidebars.js
```

```mdx-code-block
</TabItem>
<TabItem value="Older version structure">
```

```bash
# The new file.
versioned_docs/version-1.0.0/new.md

# Edit the corresponding sidebar file.
versioned_sidebars/version-1.0.0-sidebars.json
```

```mdx-code-block
</TabItem>
</Tabs>
```

:::tip

ç‰ˆæœ¬å¼ä¾§è¾¹æ æ–‡ä»¶åƒæ ‡å‡†ä¾§è¾¹æ æ–‡ä»¶ä¸€æ ·ï¼Œ ç›¸å¯¹äºç»™å®šç‰ˆæœ¬çš„å†…å®¹æ ¹ç›®å½•ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ‚¨çš„ç‰ˆæœ¬çš„ä¾§è¾¹æ æ–‡ä»¶å¯èƒ½ä¼šçœ‹èµ·æ¥åƒï¼š

```json
{
  "sidebar": [
    {
      "type": "autogenerated",
      "dirName": "."
    }
  ]
}
```

æˆ–æ‰‹åŠ¨è®¾ç½®ä¾§è¾¹æ ï¼š

```json
{
  "sidebar": [
    {
      "type": "doc",
      "id": "new",
      "label": "New"
    }
  ]
}
```

:::

### Updating an existing version {#updating-an-existing-version}

You can update multiple docs versions at the same time because each directory in `versioned_docs/` represents specific routes when published.

1. ç¼–è¾‘ä»»ä½•æ–‡ä»¶ã€‚
2. æäº¤å¹¶æ¨é€æ›´æ”¹ã€‚
3. å®ƒä¼šè¢«å‘å¸ƒåˆ°å¯¹åº”ç‰ˆæœ¬ã€‚

Example: When you change any file in `versioned_docs/version-2.6/`, it will only affect the docs for version `2.6`.

### Deleting an existing version {#deleting-an-existing-version}

ä½ ä¹Ÿå¯ä»¥åˆ é™¤ç‰ˆæœ¬ã€‚

1. Remove the version from `versions.json`.

ç¤ºä¾‹ï¼š

```diff
[
  "2.0.0",
  "1.9.0",
  // highlight-next-line
- "1.8.0"
]
```

2. åˆ é™¤ç‰ˆæœ¬åŒ–æ–‡æ¡£ç›®å½•ã€‚ Example: `versioned_docs/version-1.8.0`.
3. åˆ é™¤ç‰ˆæœ¬åŒ–ä¾§è¾¹æ æ–‡ä»¶ã€‚ Example: `versioned_sidebars/version-1.8.0-sidebars.json`.

## Configuring versioning behavior {#configuring-versioning-behavior}

The "current" version is the version name for the `./docs` folder. ç‰ˆæœ¬ç®¡ç†çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œä½†æœ‰ä¸¤ä¸ªéå¸¸å¸¸è§çš„æ¨¡å¼ï¼š

- ä½ å‘å¸ƒäº† v1ï¼Œç„¶åç«‹åˆ»å¼€å§‹ç€æ‰‹äº v2ï¼ˆåŒ…æ‹¬å…¶æ–‡æ¡£ï¼‰ã€‚ In this case, the **current version** is v2, which is in the `./docs` source folder, and can be browsed at `example.com/docs/next`. The **latest version** is v1, which is in the `./versioned_docs/version-1` source folder, and is browsed by most of your users at `example.com/docs`.
- ä½ å‘å¸ƒäº† v1ï¼Œå¹¶ä¼šç»´æŠ¤å®ƒä¸€æ®µæ—¶é—´ï¼Œç„¶åå†è€ƒè™‘ v2ã€‚ In this case, the **current version** and **latest version** will both be point to v1, since the v2 docs doesn't even exist yet!

Docusaurus çš„é»˜è®¤è®¾ç½®æ›´é€‚åˆç¬¬ä¸€ç§æƒ…å½¢ã€‚ æˆ‘ä»¬ä¼šæŠŠå½“å‰ç‰ˆæœ¬æ ‡ä¸ºã€Œä¸‹ä¸€ç‰ˆæœ¬ã€(next)ï¼Œä½ ç”šè‡³å¯ä»¥é€‰æ‹©ä¸å‘å¸ƒå®ƒã€‚

**For the 2nd use case**: if you release v1 and don't plan to work on v2 anytime soon, instead of versioning v1 and having to maintain the docs in 2 folders (`./docs` + `./versioned_docs/version-1.0.0`), you may consider "pretending" that the current version is a cut version by giving it a path and a label:

```js title="docusaurus.config.js"
export default {
  presets: [
    '@docusaurus/preset-classic',
    docs: {
      // highlight-start
      lastVersion: 'current',
      versions: {
        current: {
          label: '1.0.0',
          path: '1.0.0',
        },
      },
      // highlight-end
    },
  ],
};
```

The docs in `./docs` will be served at `/docs/1.0.0` instead of `/docs/next`, and `1.0.0` will become the default version we link to in the navbar dropdown, and you will only need to maintain a single `./docs` folder.

æˆ‘ä»¬æä¾›è¿™äº›æ’ä»¶é€‰é¡¹æ¥è‡ªå®šä¹‰ç‰ˆæœ¬è¡Œä¸ºï¼š

- `disableVersioning`: Explicitly disable versioning even with versions. è¿™ä¼šè®©ç½‘ç«™åªåŒ…å«å½“å‰ç‰ˆæœ¬ã€‚
- `includeCurrentVersion`: Include the current version (the `./docs` folder) of your docs.
  - **Tip**: turn it off if the current version is a work-in-progress, not ready to be published.
- `lastVersion`: Sets which version "latest version" (the `/docs` route) refers to.
  - **Tip**: `lastVersion: 'current'` makes sense if your current version refers to a major version that's constantly patched and released. æœ€æ–°ç‰ˆæœ¬çš„å®é™… URL è·¯å¾„å‰ç¼€å’Œæ ‡ç­¾éƒ½æ˜¯å¯ä»¥è®¾ç½®çš„ã€‚
- `onlyIncludeVersions`: Defines a subset of versions from `versions.json` to be deployed.
  - **Tip**: limit to 2 or 3 versions in dev and deploy previews to improve startup and build time.
- `versions`: A dictionary of version metadata. å¯¹äºæ¯ä¸ªç‰ˆæœ¬ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ä»¥ä¸‹å†…å®¹ï¼š
  - `label`: the label displayed in the versions dropdown and banner.
  - `path`: the route base path of this version. By default, latest version has `/` and current version has `/next`.
  - `banner`: one of `'none'`, `'unreleased'`, and `'unmaintained'`. å†³å®šæ¯ä¸ªæ–‡æ¡£é¡µé¢çš„é¡¶éƒ¨æ˜¾ç¤ºä»€ä¹ˆæ¨ªå¹…ã€‚ æ‰€æœ‰åœ¨æœ€æ–°ç‰ˆæœ¬ä¹‹åçš„ç‰ˆæœ¬éƒ½æ˜¯ã€Œæœªå‘å¸ƒã€("unreleased")ï¼Œè€Œåœ¨æœ€æ–°ç‰ˆæœ¬ä¹‹å‰çš„ç‰ˆæœ¬éƒ½æ˜¯ã€Œåœæ­¢ç»´æŠ¤ã€("unmaintained")ã€‚
  - `badge`: show a badge with the version name at the top of a doc of that version.
  - `className`: add a custom `className` to the `<html>` element of doc pages of that version.

See [docs plugin configuration](../../api/plugins/plugin-content-docs.mdx#configuration) for more details.

## Navbar items {#navbar-items}

æˆ‘ä»¬æä¾›äº†å‡ ç§å¯¼èˆªæ é¡¹ç›®ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿè®¾ç½®å¯¼èˆªï¼Œä¸éœ€è¦æ“å¿ƒç‰ˆæœ¬åŒ–çš„è·¯å¾„ã€‚

- [`doc`](../../api/themes/theme-configuration.mdx#navbar-doc-link): a link to a doc.
- [`docSidebar`](../../api/themes/theme-configuration.mdx#navbar-doc-sidebar): a link to the first item in a sidebar.
- [`docsVersion`](../../api/themes/theme-configuration.mdx#navbar-docs-version): a link to the main doc of the currently viewed version.
- [`docsVersionDropdown`](../../api/themes/theme-configuration.mdx#navbar-docs-version-dropdown): a dropdown containing all the versions available.

è¿™äº›é“¾æ¥éƒ½ä¼šè‡ªåŠ¨å¯»æ‰¾è‡ªå·±åº”è¯¥æŒ‡å‘çš„ç‰ˆæœ¬ï¼ŒæŒ‰ç…§å¦‚ä¸‹ä¼˜å…ˆçº§ï¼š

1. **Active version**: the version that the user is currently browsing, if she is on a page provided by this doc plugin. å¦‚æœç”¨æˆ·ä¸åœ¨æµè§ˆæ–‡æ¡£é¡µé¢ï¼Œä¼šå›é€€åˆ°â€¦â€¦
2. **Preferred version**: the version that the user last viewed. å¦‚æœæ²¡æœ‰å†å²è®°å½•ï¼Œä¼šå›é€€åˆ°â€¦â€¦
3. **Latest version**: the default version that we navigate to, configured by the `lastVersion` option.

## Recommended practices {#recommended-practices}

### Version your documentation only when needed {#version-your-documentation-only-when-needed}

For example, you are building documentation for your npm package `foo` and you are currently in version 1.0.0. ä½ éšåä¿®äº†ä¸€ä¸ªå° bugï¼Œå‘å¸ƒäº†ä¸€ä¸ªä¿®å¤ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·ç°åœ¨æ˜¯ 1.0.1 äº†ã€‚

ä½ åº”è¯¥å‘å¸ƒæ–°çš„ 1.0.1 ç‰ˆæœ¬æ–‡æ¡£å—ï¼Ÿ **You probably shouldn't**. æŒ‰ç…§è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼Œ1.0.1 å’Œ 1.0.0 çš„æ–‡æ¡£ä¸åº”è¯¥æœ‰åŒºåˆ«ï¼Œå› ä¸ºæ²¡æœ‰æ–°åŠŸèƒ½ï¼ è¿™æ—¶å€™åˆ’åˆ†æ–°ç‰ˆæœ¬åªä¼šåˆ›é€ ä¸å¿…è¦çš„é‡å¤æ–‡ä»¶ã€‚

### Keep the number of versions small {#keep-the-number-of-versions-small}

ä¸€ä¸ªå¥½ç”¨çš„ç»éªŒæ³•åˆ™æ˜¯ï¼ŒæŠŠç‰ˆæœ¬æ•°é‡ä¿æŒåœ¨ 10 ä»¥ä¸‹ã€‚ You will **very likely** to have a lot of obsolete versioned documentation that nobody even reads anymore. For example, [Jest](https://jestjs.io/versions) is currently in version `27.4`, and only maintains several latest documentation versions with the lowest being `25.X`. æŠŠç‰ˆæœ¬å¼„å°‘ä¸€ç‚¹ ğŸ˜Š

:::tip archive older versions

If you deploy your site on a Jamstack provider (e.g. [Netlify](../../deployment.mdx)), the provider will save each production build as a snapshot under an immutable URL. ä½ å¯ä»¥æŠŠé‚£äº›å†ä¹Ÿä¸ä¼šé‡æ–°æ„å»ºçš„ç‰ˆæœ¬å°å­˜ï¼Œç„¶åä»¥å¤–éƒ¨é“¾æ¥çš„å½¢å¼æŒ‡å‘è¿™äº›ä¸å¯å˜ URLã€‚ Jest ç½‘ç«™å’Œ Docusaurus ç½‘ç«™éƒ½ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œä¿æŒæœ‰é™çš„æ´»è·ƒæ„å»ºç‰ˆæœ¬æ•°é‡ã€‚

:::

### Use absolute import within the docs {#use-absolute-import-within-the-docs}

ä¸è¦åœ¨æ–‡æ¡£ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¯¼å…¥ã€‚ å› ä¸ºå½“æˆ‘ä»¬åˆ’åˆ†ç‰ˆæœ¬åï¼Œè¿™äº›è·¯å¾„å°±ä¸å†èµ·ä½œç”¨äº†ï¼ˆå› ä¸ºæ–‡ä»¶å¤¹åµŒå¥—å±‚çº§ä¸ä¸€æ ·äº†ï¼Œç­‰ç­‰ï¼‰ã€‚ You can utilize the `@site` alias provided by Docusaurus that points to the `website` directory. ç¤ºä¾‹ï¼š

```diff
- import Foo from '../src/components/Foo';
+ import Foo from '@site/src/components/Foo';
```

### Link docs by file paths {#link-docs-by-file-paths}

Refer to other docs by relative file paths with the `.md` extension, so that Docusaurus can rewrite them to actual URL paths during building. æ–‡ä»¶ä¼šè¢«é“¾æ¥åˆ°æ­£ç¡®çš„å¯¹åº”ç‰ˆæœ¬ã€‚

```md
The [@hello](hello.mdx#paginate) document is great!

See the [Tutorial](../getting-started/tutorial.mdx) for more info.
```

### Global or versioned collocated assets {#global-or-versioned-collocated-assets}

ä½ éœ€è¦å†³å®šåƒå›¾åƒå’Œæ–‡ä»¶è¿™æ ·çš„èµ„æºæ˜¯æ¯ä¸ªç‰ˆæœ¬ä¸“æœ‰çš„ï¼Œè¿˜æ˜¯åœ¨ç‰ˆæœ¬ä¹‹é—´å…±äº«ã€‚

å¦‚æœä½ çš„èµ„æºæ˜¯å’Œç‰ˆæœ¬ç›¸å…³çš„ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ç‰ˆæœ¬æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼š

```md
![å›¾ç‰‡ alt](./myImage.png)

[ä¸‹è½½æ­¤æ–‡ä»¶](./file.pdf)
```

If your assets are global, put them in `/static` and use absolute paths:

```md
![å›¾ç‰‡ alt](/myImage.png)

[ä¸‹è½½æ­¤æ–‡ä»¶](/file.pdf)
```
